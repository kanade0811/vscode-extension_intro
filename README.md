# vscode-extension_intro

この講座では、主に自身のコーディングの手助けとなるような拡張機能の作成と使用を目的としています。  
~~ちなみに主は作成を途中で放棄して半ば諦めています~~



## 目次
1. Node.jsのDLとinst  
2. 雛型の作成
3. 



## 1.Node.jsのDLとinst

[https://nodejs.org/ja/download](https://nodejs.org/ja/download)からLTS版をDLする。

> [!NOTE]
> そのほかの設定はそのままで大丈夫(多分)

その後、インストーラーでインストールする。

> [!TIP]
> ターミナルに以下のコマンドを1行ずつ打ち込む
> ```bash
> node -v
> pnm -v
> ```
> それぞれバージョンが表示されれば正しく入っています  
> そうでなければ上手く入っていないため、良い感じに頑張ってください



## 2.雛型の作成

今回は、テンプレートを作成して拡張機能を作っていきます

```bash
// 次の`yo code`を使えるようにするための作成コマンド
npm install -g yo generator-code
// 拡張機能を作成するためのテンプレートを作成する
yo code
```

→可愛いおじさんの質問にええ感じに答えていく  
　![カワおじ](./images/kawaozi.png)  
以下、特に重要(と主が思っている)部分を抜粋

```
? What's the identifier of your extension?
// そのままエンター押せば何とかなる(らしい)
? Initialize a git repository? No
// gitリポジトリを作るならここ
// (既にリポジトリをクローンした中でy答えると二重になるから注意by前科1犯)
? Which package manager to use? npm
// ここはnpmを選択
```

ここまで入れるとぐわーって色々出てきます、待ちましょう  
![主のスクショ](./images/questions.png)

```
? Do you want to open the new folder with Visual Studio Code?
// 作成したファイルを開くかの質問、そのままエンター
```

これで、無事に拡張機能のテンプレートを作成し、開くことができました㊗


## 3.テンプレートの構造理解と実行環境

では実際にコードを作っていきましょう！  
……の前に、まず何が何なのかを知らないといけませんよね

以下がよく使うファイルの例です(TypeScripttの場合)

> `package.json`  
> →拡張機能の設定をするファイル。大事。  
> `src/extension.ts`  
> →実際に拡張機能の処理を書くファイル。めっちゃ大事。

ここまで理解したところで、実際に作成中の拡張機能を動かしてみましょう！

```bash
npm run compile
```

このコマンドを実行してみましょう。
これで1つファイルが増えたことに気付きましたか？  
`out`というファイルが作られ、中に色々出来ましたね  

ここで一つ、めちゃめちゃ大事なファイルが作成されました

> `out/extension.js`  
> →`extension.ts`を元にして、作られたjsファイル  
> 　実際にはこのファイルが実行されることになります

これで実際に動かせる環境は揃いました！  
`Fn`+`F5`を押せば「拡張機能開発ホスト」という、今作ってる拡張機能が実際に動くような新しいVScodeのウィンドウを作れます  

次のセクションで、実際にサンプルとして作られている機能を実行してみましょう！


## 4.作成した拡張機能の実行

先ほど出てきた「拡張機能ホスト」というウィンドウから、テストとして今作っている拡張機能を試しに使うことができます。  
ここで一つ、機能を実際に使ってみましょう。

`yo code`にて作られたテンプレートは、「VScodeのコマンドパレットに`Hello World`と入れると、`Hello World from sample!`と表示される」という機能を持ってます。  
では、実際に動かしてみましょう。

`Ctrl`+`Shift`+`P`でコマンドパレットを開き、`Hello World`と打ち選択しましょう。  
すると、右下の通知に`Hello World from sample!`と表示されると思います。

### なんて~~カス~~素晴らしい拡張機能なんでしょう！！！



## 5.拡張機能の作成

では、この~~カス~~素晴らしいコードを編集して、実際に自分が作りたいような拡張機能を作りましょう！
TypeScriptなら`src/extension.ts`、JavaScriptなら`extension.js`の中身を編集することで、コードを機能に追加することができます。

正直中身をどう作るかは今回の講座の範囲外なので、自分で調べてやりたいようにやってください。

TypeScriptの場合はビルドが必要なため、更新するたびにターミナルで`npm run compile`と入れないといけません。JavaScriptの場合は、そのまま次に進めます。  
`Ctrl`+`Shift`+`F5`を押すことで、拡張機能ホストを再起動し、現在のコードを反映させることができます。  

> [!IMPORTANT]
> `Fn`+`F5`  
> →拡張機能ホストを**起動**する。1番最初はこれ。  
> `Ctrl`+`Shift`+`F5`  
> →拡張機能ホストを**再起動**する。2回目以降に動かすときはこれ。



## 6.拡張機能のエクスポート

早く中身を作りたくてソワソワしていると思いますが、先に出力の仕方を知っちゃいましょう。  
今回は、`.vsix`というファイルで使えるようにします。  
自分は勿論、そのファイルを配布すれば他の人も使えるようになります。ｽｺﾞｲﾈ!

パッケージ化する前に、`README.md`を編集しないといけないという謎エラーが出るので、適当に全部消すなりしましょう。  
そしてターミナルで、以下のコマンドを実行しましょう。

```bash
// "Visual Studio Code Extension"というのをインストール
npm install -g @vscode/vsce
// 作成した拡張機能をパッケージ化
vsce package
```

gitリポジトリが無いとかライセンス化が云々とか言われるんですが、テストなのでそのまま進めちゃってください。  
`DONE`と表示されれば、先ほどまでのフォルダに`(ファイル名)-0.0.1.vsix`というファイルが作られていると思います。  